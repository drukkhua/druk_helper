# JSON —Ñ–∞–π–ª—ã vs MySQL - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏ –¥–∏–∞–ª–æ–≥–æ–≤

## –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### ‚ö° **–°–∫–æ—Ä–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã)**

| –û–ø–µ—Ä–∞—Ü–∏—è | JSON —Ñ–∞–π–ª—ã | MySQL | –†–∞–∑–Ω–∏—Ü–∞ |
|----------|------------|-------|---------|
| **–ó–∞–ø–∏—Å—å –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è** | 5-15 –º—Å | 1-3 –º—Å | MySQL **–±—ã—Å—Ç—Ä–µ–µ –≤ 3-5x** |
| **–ß—Ç–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ—Å—Å–∏–∏** | 10-25 –º—Å | 2-5 –º—Å | MySQL **–±—ã—Å—Ç—Ä–µ–µ –≤ 4x** |
| **–ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏** | 100-1000+ –º—Å | 5-20 –º—Å | MySQL **–±—ã—Å—Ç—Ä–µ–µ –≤ 50x** |
| **–ú–∞—Å—Å–æ–≤–∞—è –∑–∞–ø–∏—Å—å (100 –∑–∞–ø–∏—Å–µ–π)** | 500-1500 –º—Å | 50-150 –º—Å | MySQL **–±—ã—Å—Ç—Ä–µ–µ –≤ 10x** |

### üíæ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**

| –†–µ—Å—É—Ä—Å | JSON —Ñ–∞–π–ª—ã | MySQL | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|------------|-------|-------------|
| **RAM** | 10-50 –ú–ë | 50-200 –ú–ë | JSON —ç–∫–æ–Ω–æ–º–∏—á–Ω–µ–µ |
| **CPU** | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∞—è | MySQL –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω |
| **–î–∏—Å–∫ I/O** | –í—ã—Å–æ–∫–∞—è | –ù–∏–∑–∫–∞—è | MySQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ |
| **–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è** | –í—ã—Å–æ–∫–∞—è | –ù–∏–∑–∫–∞—è | JSON —Å–æ–∑–¥–∞–µ—Ç –º–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤ |

## –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –Ω–∞–≥—Ä—É–∑–∫–µ

### üìä **1. –ù–∏–∑–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (–¥–æ 1,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–µ–Ω—å)**

```python
# JSON –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
def save_message_json(user_id, message):
    # –í—Ä–µ–º—è: 10-15 –º—Å
    file_path = f"./data/conversations/session_{user_id}.json"

    # 1. –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ (5-10 –º—Å)
    with open(file_path, 'r') as f:
        data = json.load(f)

    # 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (0.1 –º—Å)
    data['messages'].append(message)

    # 3. –ó–∞–ø–∏—Å—å —Ñ–∞–π–ª–∞ (5-10 –º—Å)
    with open(file_path, 'w') as f:
        json.dump(data, f)

# MySQL –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
def save_message_mysql(user_id, message):
    # –í—Ä–µ–º—è: 2-3 –º—Å
    cursor.execute(
        "INSERT INTO messages (user_id, content, timestamp) VALUES (%s, %s, %s)",
        (user_id, message, time.time())
    )
    # MySQL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –∏ –∫–µ—à–∏—Ä—É–µ—Ç
```

**–í—ã–≤–æ–¥ –¥–ª—è –Ω–∏–∑–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏:** JSON –ø—Ä–∏–µ–º–ª–µ–º, —Ä–∞–∑–Ω–∏—Ü–∞ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞

### üìä **2. –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞ (10,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–µ–Ω—å)**

```python
# –ü—Ä–æ–±–ª–µ–º—ã JSON –ø—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏:
def concurrent_json_writes():
    # –ü—Ä–æ–±–ª–µ–º–∞ 1: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤
    # –ï—Å–ª–∏ 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–∏—à—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ -> –æ—à–∏–±–∫–∞

    # –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–∞
    # –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è 1 —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤–µ—Å—å —Ñ–∞–π–ª

    # –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
    # –ü—Ä–∏ —Å–±–æ–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ—Ä—Ç–∏—Ç—å—Å—è

    # –ü—Ä–æ–±–ª–µ–º–∞ 4: –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫
    # –ü–æ–∏—Å–∫ –ø–æ 10–ö —Ñ–∞–π–ª–æ–≤ = –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ

# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ MySQL:
def concurrent_mysql_writes():
    # ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
    # ‚úÖ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
    # ‚úÖ ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    # ‚úÖ –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫
```

**–í—ã–≤–æ–¥ –¥–ª—è —Å—Ä–µ–¥–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏:** MySQL –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ

### üìä **3. –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (100,000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–µ–Ω—å)**

| –ú–µ—Ç—Ä–∏–∫–∞ | JSON | MySQL |
|---------|------|-------|
| **–ó–∞–ø–∏—Å—å –≤ —Å–µ–∫—É–Ω–¥—É** | 10-50 | 1000-5000 |
| **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** | 1-5 | 100-1000 |
| **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞** | 50-500 –º—Å | 1-10 –º—Å |
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è |

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üß™ **–¢–µ—Å—Ç 1: –ó–∞–ø–∏—Å—å 1000 —Å–æ–æ–±—â–µ–Ω–∏–π**

```python
import time

# JSON —Ç–µ—Å—Ç
start_time = time.time()
for i in range(1000):
    save_message_to_json(f"user_{i}", f"message_{i}")
json_time = time.time() - start_time
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 8-15 —Å–µ–∫—É–Ω–¥

# MySQL —Ç–µ—Å—Ç
start_time = time.time()
for i in range(1000):
    save_message_to_mysql(f"user_{i}", f"message_{i}")
mysql_time = time.time() - start_time
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 0.5-2 —Å–µ–∫—É–Ω–¥—ã

print(f"MySQL –±—ã—Å—Ç—Ä–µ–µ –≤ {json_time / mysql_time:.1f} —Ä–∞–∑")
```

### üß™ **–¢–µ—Å—Ç 2: –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏**

```python
# –ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é

# JSON –ø–æ–¥—Ö–æ–¥
def search_json_history(user_id, days=7):
    # –í—Ä–µ–º—è: 100-1000+ –º—Å
    file_path = f"./data/conversations/session_{user_id}.json"

    with open(file_path, 'r') as f:
        data = json.load(f)  # –ó–∞–≥—Ä—É–∂–∞–µ–º –í–°–ï —Å–æ–æ–±—â–µ–Ω–∏—è

    cutoff = time.time() - (days * 24 * 3600)
    results = []

    # –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è–º
    for msg in data['messages']:
        if msg['timestamp'] > cutoff:
            results.append(msg)

    return results

# MySQL –ø–æ–¥—Ö–æ–¥
def search_mysql_history(user_id, days=7):
    # –í—Ä–µ–º—è: 5-20 –º—Å
    cutoff = time.time() - (days * 24 * 3600)

    cursor.execute("""
        SELECT * FROM messages
        WHERE user_id = %s AND timestamp > %s
        ORDER BY timestamp DESC
    """, (user_id, cutoff))

    return cursor.fetchall()  # –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º

### üéØ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

| –ö—Ä–∏—Ç–µ—Ä–∏–π | JSON | MySQL | –ü–æ–±–µ–¥–∏—Ç–µ–ª—å |
|----------|------|-------|------------|
| –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **MySQL** |
| –°–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **MySQL** |
| –ü–æ–∏—Å–∫/—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è | ‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **MySQL** |
| –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ | ‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **MySQL** |

### üõ†Ô∏è **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**

| –ö—Ä–∏—Ç–µ—Ä–∏–π | JSON | MySQL | –ü–æ–±–µ–¥–∏—Ç–µ–ª—å |
|----------|------|-------|------------|
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê | **JSON** |
| –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | **JSON** |
| –û—Ç–ª–∞–¥–∫–∞ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | **JSON** |
| –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | **MySQL** |

### üí∞ **–†–µ—Å—É—Ä—Å—ã**

| –ö—Ä–∏—Ç–µ—Ä–∏–π | JSON | MySQL | –ü–æ–±–µ–¥–∏—Ç–µ–ª—å |
|----------|------|-------|------------|
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAM | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | **JSON** |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **MySQL** |
| –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **MySQL** |
| –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê | **JSON** |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

### üìã **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JSON:**

‚úÖ **–ü–æ–¥—Ö–æ–¥–∏—Ç –µ—Å–ª–∏:**
- < 1,000 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–Ω—å
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤–∞–∂–Ω–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ù–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤
- –ö–æ–º–∞–Ω–¥–∞ –Ω–µ –∏–º–µ–µ—Ç –æ–ø—ã—Ç–∞ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Ä—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å

‚ùå **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –µ—Å–ª–∏:**
- > 5,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–Ω—å
- –ù—É–∂–µ–Ω –ø–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤
- –í–∞–∂–Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –¥–∏–∞–ª–æ–≥–∞–º
- –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üìã **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MySQL:**

‚úÖ **–ü–æ–¥—Ö–æ–¥–∏—Ç –µ—Å–ª–∏:**
- > 1,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–Ω—å
- –ù—É–∂–Ω–∞ –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–∏—Å–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –¥–∏–∞–ª–æ–≥–∞–º
- –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –í–∞–∂–Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ ACID —Å–≤–æ–π—Å—Ç–≤–∞

‚ùå **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –µ—Å–ª–∏:**
- –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–µ–∫—Ç
- –ù–µ—Ç –æ–ø—ã—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î
- –ö—Ä–∏—Ç–∏—á–Ω–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

### üîÑ **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**

```python
class HybridConversationStorage:
    """–ì–∏–±—Ä–∏–¥–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ: MySQL –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, JSON –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""

    def __init__(self):
        # MySQL –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
        self.mysql_conn = mysql.connector.connect(...)

        # JSON –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ)
        self.json_path = "./data/conversations/"

    def save_message(self, user_id, message, metadata):
        # 1. –ë—ã—Å—Ç—Ä–∞—è –∑–∞–ø–∏—Å—å –≤ MySQL (–æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è)
        cursor.execute("""
            INSERT INTO message_index
            (user_id, timestamp, message_hash, has_metadata)
            VALUES (%s, %s, %s, %s)
        """, (user_id, time.time(), hash(message), bool(metadata)))

        # 2. –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ JSON (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
        if self.need_full_content(message, metadata):
            self.save_to_json(user_id, message, metadata)

    def search_messages(self, user_id, filters):
        # –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ MySQL
        results = self.mysql_search(user_id, filters)

        # –ü–æ–¥–≥—Ä—É–∂–∞–µ–º –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        for result in results:
            if result['needs_full_content']:
                result['full_data'] = self.load_from_json(result['id'])

        return results
```

## –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### üéØ **–î–ª—è –≤–∞—à–µ–≥–æ —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∞:**

**JSON —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ –¥–æ 5,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–Ω—å**

**–ù–æ MySQL –¥–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **–í 3-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ** –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –Ω–µ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ —Ä–∞—Å—Ç–µ—Ç —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - –ø—Ä–æ—Å—Ç—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è upselling –∞–Ω–∞–ª–∏–∑–∞

### üöÄ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**

1. **–°–µ–π—á–∞—Å:** –û—Å—Ç–∞–≤—å—Ç–µ JSON (—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
2. **–ü—Ä–∏ —Ä–æ—Å—Ç–µ –¥–æ 2-3–ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** –î–æ–±–∞–≤—å—Ç–µ MySQL –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
3. **–ü—Ä–∏ —Ä–æ—Å—Ç–µ –¥–æ 5–ö+:** –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ MySQL
4. **–î–ª—è enterprise:** –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ PostgreSQL –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

**–í—ã–≤–æ–¥:** JSON –≤ 3-10 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ MySQL, –Ω–æ –¥–ª—è –º–∞–ª–æ–≥–æ/—Å—Ä–µ–¥–Ω–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ —Ä–∞–∑–Ω–∏—Ü–∞ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞. MySQL —Å—Ç–æ–∏—Ç –≤–Ω–µ–¥—Ä—è—Ç—å –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ä–æ—Å—Ç–∞.
