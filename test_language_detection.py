#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞
"""

import sys
import os

sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from src.core.template_manager import TemplateManager


def test_language_detection():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞"""

    manager = TemplateManager()

    # –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã
    test_cases = [
        # –£–∫—Ä–∞–∏–Ω—Å–∫–∏–µ —Ñ—Ä–∞–∑—ã
        ("–°–∫—ñ–ª—å–∫–∏ –∫–æ—à—Ç—É—é—Ç—å –≤—ñ–∑–∏—Ç–∫–∏?", "ukr"),
        ("–ü–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–¥—Ä—É–∫—É–≤–∞—Ç–∏ –ª–∏—Å—Ç—ñ–≤–∫–∏", "ukr"),
        ("–Ø–∫–∞ —Ü—ñ–Ω–∞ –Ω–∞ —Ñ—É—Ç–±–æ–ª–∫–∏?", "ukr"),
        ("–î—è–∫—É—é –∑–∞ –¥–æ–ø–æ–º–æ–≥—É", "ukr"),
        ("–©–æ —Ç–∞–∫–µ —Ç–∏—Å–Ω–µ–Ω–Ω—è —Ñ–æ–ª—å–≥–æ—é?", "ukr"),
        ("–ú–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –Ω–∞–∫–ª–µ–π–∫–∏?", "ukr"),
        # –†—É—Å—Å–∫–∏–µ —Ñ—Ä–∞–∑—ã
        ("–°–∫–æ–ª—å–∫–æ —Å—Ç–æ—è—Ç –≤–∏–∑–∏—Ç–∫–∏?", "rus"),
        ("–ù—É–∂–Ω–æ –Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å –ª–∏—Å—Ç–æ–≤–∫–∏", "rus"),
        ("–ö–∞–∫–∞—è —Ü–µ–Ω–∞ –Ω–∞ —Ñ—É—Ç–±–æ–ª–∫–∏?", "rus"),
        ("–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å", "rus"),
        ("–ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–∏—Å–Ω–µ–Ω–∏–µ —Ñ–æ–ª—å–≥–æ–π?", "rus"),
        ("–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞–∫–ª–µ–π–∫–∏?", "rus"),
        # –°–º–µ—à–∞–Ω–Ω—ã–µ –∏ —Å–ª–æ–∂–Ω—ã–µ —Å–ª—É—á–∞–∏
        ("–ü—Ä–∏–≤—ñ—Ç! –°–∫—ñ–ª—å–∫–∏ –∫–æ—à—Ç—É—î –¥—Ä—É–∫ –≤—ñ–∑–∏—Ç–æ–∫?", "ukr"),
        ("–ü—Ä–∏–≤–µ—Ç! –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –ø–µ—á–∞—Ç—å –≤–∏–∑–∏—Ç–æ–∫?", "rus"),
        ("—Ñ–æ–ª—å–≥—É–≤–∞–Ω–Ω—è", "ukr"),
        ("—Ñ–æ–ª—å–≥–∏—Ä–æ–≤–∞–Ω–∏–µ", "rus"),
    ]

    print("=== –¢–µ—Å—Ç –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞ ===\n")

    correct = 0
    total = len(test_cases)

    for text, expected_lang in test_cases:
        detected_lang = manager.detect_language(text)
        status = "‚úÖ" if detected_lang == expected_lang else "‚ùå"

        print(f"{status} '{text}'")
        print(f"   –û–∂–∏–¥–∞–ª—Å—è: {expected_lang}, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω: {detected_lang}")

        if detected_lang == expected_lang:
            correct += 1
        print()

    accuracy = (correct / total) * 100
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {correct}/{total} ({accuracy:.1f}% —Ç–æ—á–Ω–æ—Å—Ç—å)")

    if accuracy >= 90:
        print("üéâ –û—Ç–ª–∏—á–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞!")
    elif accuracy >= 80:
        print("üëç –•–æ—Ä–æ—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞")
    else:
        print("‚ö†Ô∏è –ù—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞")


if __name__ == "__main__":
    test_language_detection()
