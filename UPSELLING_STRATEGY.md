# –°—Ç—Ä–∞—Ç–µ–≥–∏—è —É–º–Ω–æ–≥–æ upselling —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### üéØ **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
1. **–ë–∞–∑–æ–≤—ã–π –æ—Ç–≤–µ—Ç** (priority 10) - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
2. **Premium –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è** (priority 8-9) - —É–ª—É—á—à–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
3. **–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –æ–ø—Ü–∏–∏** (priority 6-7) - –ø—Ä–µ–º–∏—É–º —É—Å–ª—É–≥–∏

## –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –≥—Ä—É–ø–ø—ã –∏ —Ä–∞–∑–¥–µ–ª—ã

### üìä **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥—Ä—É–ø–ø:**

#### **–û—Å–Ω–æ–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ):**
- `—Å—Ä–æ–∫–∏` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏
- `—Ü–µ–Ω–∞` - —Å—Ç–æ–∏–º–æ—Å—Ç—å –±–∞–∑–æ–≤—ã—Ö —É—Å–ª—É–≥
- `–º–∞–∫–µ—Ç` - –¥–∏–∑–∞–π–Ω –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- `–º–∞—Ç–µ—Ä–∏–∞–ª—ã` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

#### **–ù–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã –¥–ª—è upselling:**
- `–ø—Ä–µ–º–∏—É–º_–º–∞—Ç–µ—Ä–∏–∞–ª—ã` - —É–ª—É—á—à–µ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- `—Å–ø–µ—Ü—ç—Ñ—Ñ–µ–∫—Ç—ã` - —Ç–∏—Å–Ω–µ–Ω–∏–µ, –ª–∞–º–∏–Ω–∞—Ü–∏—è, –£–§-–ª–∞–∫
- `–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ_—Ñ–æ—Ä–º–∞—Ç—ã` - –æ—Å–æ–±—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏ —Ñ–æ—Ä–º—ã
- `—Å—Ä–æ—á–Ω–æ–µ_–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ` - —É—Å–∫–æ—Ä–µ–Ω–Ω—ã–µ —Å—Ä–æ–∫–∏
- `–±–æ–ª—å—à–∏–µ_—Ç–∏—Ä–∞–∂–∏` - –æ–ø—Ç–æ–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- `–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ_—Ä–µ—à–µ–Ω–∏—è` - –ø–∞–∫–µ—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è

## –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

### üî¢ **–®–∫–∞–ª–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ (1-10):**

**10 - –ë–∞–∑–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã** (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ–≥–¥–∞):
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ü–µ–Ω—ã
- –û–±—ã—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ä–æ–∫–∏

**8-9 - –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è** (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —á–∞—Å—Ç–æ):
- –õ–∞–º–∏–Ω–∞—Ü–∏—è
- –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Ç–∏—Ä–∞–∂–∏
- –£—Å–∫–æ—Ä–µ–Ω–Ω—ã–µ —Å—Ä–æ–∫–∏

**6-7 - –ü—Ä–µ–º–∏—É–º –æ–ø—Ü–∏–∏** (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∏–Ω—Ç–µ—Ä–µ—Å–µ):
- –¢–∏—Å–Ω–µ–Ω–∏–µ —Ñ–æ–ª—å–≥–æ–π
- –î–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è –ø–µ—á–∞—Ç—å

**4-5 - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è** (–ø–æ –∑–∞–ø—Ä–æ—Å—É):
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

## –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üìã **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**

```csv
category,group,keywords,answer_ukr,answer_rus,priority,upsell_trigger,price_range
–≤–∏–∑–∏—Ç–∫–∏,—Ü–µ–Ω–∞,"—Ü–µ–Ω–∞,—Å—Ç–æ–∏–º–æ—Å—Ç—å","96 —à—Ç –∑–∞ 158 –≥—Ä–Ω - —Å—Ç–∞–Ω–¥–∞—Ä—Ç","96 —à—Ç –∑–∞ 158 –≥—Ä–Ω - —Å—Ç–∞–Ω–¥–∞—Ä—Ç",10,base,low
–≤–∏–∑–∏—Ç–∫–∏,–ø—Ä–µ–º–∏—É–º_–º–∞—Ç–µ—Ä–∏–∞–ª—ã,"–ø—Ä–µ–º–∏—É–º,–∫–∞—á–µ—Å—Ç–≤–æ","+ –î–∏–∑–∞–π–Ω–µ—Ä—Å—å–∫–∏–π –∫–∞—Ä—Ç–æ–Ω 400–≥/–º¬≤ - –≤—Å—å–æ–≥–æ +50 –≥—Ä–Ω","+ –î–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∏–π –∫–∞—Ä—Ç–æ–Ω 400–≥/–º¬≤ - –≤—Å–µ–≥–æ +50 –≥—Ä–Ω",8,price,medium
–≤–∏–∑–∏—Ç–∫–∏,—Å–ø–µ—Ü—ç—Ñ—Ñ–µ–∫—Ç—ã,"—Ç–∏—Å–Ω–µ–Ω–∏–µ,—Ñ–æ–ª—å–≥–∞","‚ú® –¢–∏—Å–Ω–µ–Ω–Ω—è –∑–æ–ª–æ—Ç–æ—é —Ñ–æ–ª—å–≥–æ—é –¥–æ–¥–∞—Å—Ç—å –ø—Ä–µ—Å—Ç–∏–∂—É - –≤—ñ–¥ +120 –≥—Ä–Ω","‚ú® –¢–∏—Å–Ω–µ–Ω–∏–µ –∑–æ–ª–æ—Ç–æ–π —Ñ–æ–ª—å–≥–æ–π –¥–æ–±–∞–≤–∏—Ç –ø—Ä–µ—Å—Ç–∏–∂–∞ - –æ—Ç +120 –≥—Ä–Ω",7,materials,high
```

### üéØ **–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∫–∞–∑–∞ upselling:**

```python
def get_enhanced_search_results(query: str, user_context: Dict) -> List[Dict]:
    """–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ —Å —É–º–Ω—ã–º upselling"""

    # 1. –ü–æ–ª—É—á–∞–µ–º –±–∞–∑–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    base_results = knowledge_base.search_knowledge(query)

    # 2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
    query_context = analyze_user_intent(query, user_context)

    # 3. –î–æ–±–∞–≤–ª—è–µ–º —É–º–µ—Å—Ç–Ω—ã–µ upselling –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
    enhanced_results = add_smart_upselling(base_results, query_context)

    return enhanced_results

def add_smart_upselling(base_results: List[Dict], context: Dict) -> List[Dict]:
    """–î–æ–±–∞–≤–ª—è–µ—Ç —É–º–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π"""

    enhanced = []

    for result in base_results:
        # –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        enhanced.append(result)

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–µ upselling –æ–ø—Ü–∏–∏
        category = result.get('metadata', {}).get('category')
        group = result.get('metadata', {}).get('subcategory')  # –Ω–∞—à–∞ group

        # –ù–∞—Ö–æ–¥–∏–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–µ–º–∏—É–º –æ–ø—Ü–∏–∏
        upsell_options = find_upselling_options(category, group, context)

        # –î–æ–±–∞–≤–ª—è–µ–º 1-2 –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –æ–ø—Ü–∏–∏
        for option in upsell_options[:2]:
            option['is_upselling'] = True
            option['relevance_score'] *= 0.8  # –ù–µ–º–Ω–æ–≥–æ —Å–Ω–∏–∂–∞–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
            enhanced.append(option)

    return enhanced

def find_upselling_options(category: str, base_group: str, context: Dict) -> List[Dict]:
    """–ù–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –æ–ø—Ü–∏–∏ –¥–ª—è upselling"""

    # –ú–∞–ø–∏–Ω–≥ –±–∞–∑–æ–≤—ã—Ö –≥—Ä—É–ø–ø –∫ upselling –≥—Ä—É–ø–ø–∞–º
    upselling_map = {
        '—Ü–µ–Ω–∞': ['–ø—Ä–µ–º–∏—É–º_–º–∞—Ç–µ—Ä–∏–∞–ª—ã', '–±–æ–ª—å—à–∏–µ_—Ç–∏—Ä–∞–∂–∏'],
        '–º–∞—Ç–µ—Ä–∏–∞–ª—ã': ['—Å–ø–µ—Ü—ç—Ñ—Ñ–µ–∫—Ç—ã', '–ø—Ä–µ–º–∏—É–º_–º–∞—Ç–µ—Ä–∏–∞–ª—ã'],
        '—Å—Ä–æ–∫–∏': ['—Å—Ä–æ—á–Ω–æ–µ_–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'],
        '–º–∞–∫–µ—Ç': ['–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ_—Ä–µ—à–µ–Ω–∏—è']
    }

    target_groups = upselling_map.get(base_group, [])

    # –ò—â–µ–º –æ–ø—Ü–∏–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≥—Ä—É–ø–ø–∞—Ö
    upsell_results = []
    for group in target_groups:
        options = knowledge_base.search_by_group(category, group)
        upsell_results.extend(options)

    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
    return sorted(upsell_results, key=lambda x: x.get('priority', 10))
```

## –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã upselling

### üé® **–í–∏–∑–∏—Ç–∫–∏:**

**–ë–∞–∑–æ–≤—ã–π –æ—Ç–≤–µ—Ç** (priority 10):
```
"96 –≤–∏–∑–∏—Ç–æ–∫ –∑–∞ 158 –≥—Ä–Ω –Ω–∞ –∫—Ä–µ–π–¥–æ–≤–∞–Ω–æ–º –ø–∞–ø–µ—Ä—ñ 350–≥/–º¬≤ –∑–∞ 1-2 –¥–Ω—ñ"
```

**Upselling –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è** (priority 8-7):
```
"‚ú® –î–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–ø—Ü—ñ—ó –¥–ª—è –≤–∞—à–∏—Ö –≤—ñ–∑–∏—Ç–æ–∫:
‚Ä¢ –õ–∞–º—ñ–Ω–∞—Ü—ñ—è (–º–∞—Ç–æ–≤–∞/–≥–ª—è–Ω—Ü–µ–≤–∞) - +60 –≥—Ä–Ω - —Ä–æ–±–∏—Ç—å –≤—ñ–∑–∏—Ç–∫–∏ –¥–æ–≤–≥–æ–≤—ñ—á–Ω–∏–º–∏
‚Ä¢ –î–∏–∑–∞–π–Ω–µ—Ä—Å—å–∫–∏–π –∫–∞—Ä—Ç–æ–Ω 400–≥/–º¬≤ - +50 –≥—Ä–Ω - –ø—Ä–µ–º—ñ—É–º –≤—ñ–¥—á—É—Ç—Ç—è
‚Ä¢ –¢–∏—Å–Ω–µ–Ω–Ω—è —Ñ–æ–ª—å–≥–æ—é - –≤—ñ–¥ +120 –≥—Ä–Ω - —Å—Ç–∞—Ç—É—Å–Ω–∏–π –≤–∏–≥–ª—è–¥"
```

### üìÑ **–õ–∏—Å—Ç–æ–≤–∫–∏:**

**–ë–∞–∑–æ–≤—ã–π –æ—Ç–≤–µ—Ç** (priority 10):
```
"–õ–∏—Å—Ç—ñ–≤–∫–∏ –ê4 –Ω–∞ –∫—Ä–µ–π–¥–æ–≤–∞–Ω–æ–º—É –ø–∞–ø–µ—Ä—ñ 130–≥/–º¬≤ - 100 —à—Ç –∑–∞ 180 –≥—Ä–Ω"
```

**Upselling** (priority 8-7):
```
"üöÄ –ó—Ä–æ–±—ñ—Ç—å –ª–∏—Å—Ç—ñ–≤–∫–∏ —â–µ –µ—Ñ–µ–∫—Ç–Ω—ñ—à–∏–º–∏:
‚Ä¢ –î—Ä—É–∫ –Ω–∞ –¥–∏–∑–∞–π–Ω–µ—Ä—Å—å–∫–æ–º—É –ø–∞–ø–µ—Ä—ñ - +40 –≥—Ä–Ω - —É–Ω—ñ–∫–∞–ª—å–Ω–∞ —Ñ–∞–∫—Ç—É—Ä–∞
‚Ä¢ –ë—ñ–≥–æ–≤–∫–∞ –¥–ª—è –±—É–∫–ª–µ—Ç—É - +25 –≥—Ä–Ω - –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–µ —Å–∫–ª–∞–¥–∞–Ω–Ω—è
‚Ä¢ –£–§-–ª–∞–∫ –Ω–∞ –ª–æ–≥–æ—Ç–∏–ø - +80 –≥—Ä–Ω - —è—Å–∫—Ä–∞–≤–∏–π –∞–∫—Ü–µ–Ω—Ç"
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### üîß **–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞:**

```python
class EnhancedKnowledgeBase(KnowledgeBase):
    """–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å upselling"""

    def search_with_upselling(self, query: str, language: str = "ukr",
                            max_upsell: int = 2) -> List[Dict]:
        """–ü–æ–∏—Å–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º upselling –æ–ø—Ü–∏–π"""

        # –ë–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫
        base_results = self.search_knowledge(query, language)

        if not base_results:
            return base_results

        enhanced_results = []

        for result in base_results:
            # –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            enhanced_results.append(result)

            # –ò—â–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ upsell –æ–ø—Ü–∏–∏
            upsell_options = self._find_related_upselling(result, language)

            # –î–æ–±–∞–≤–ª—è–µ–º –ª—É—á—à–∏–µ –æ–ø—Ü–∏–∏
            for option in upsell_options[:max_upsell]:
                option['metadata']['is_upselling'] = True
                option['metadata']['base_query'] = query
                enhanced_results.append(option)

        return enhanced_results

    def _find_related_upselling(self, base_result: Dict, language: str) -> List[Dict]:
        """–ù–∞—Ö–æ–¥–∏—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ upselling –æ–ø—Ü–∏–∏"""

        metadata = base_result.get('metadata', {})
        category = metadata.get('category')
        group = metadata.get('subcategory')  # –Ω–∞—à–∞ group

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–µ–ª–µ–≤—ã–µ –≥—Ä—É–ø–ø—ã –¥–ª—è upselling
        upsell_groups = self._get_upselling_groups(group)

        upsell_results = []
        for target_group in upsell_groups:
            # –ò—â–µ–º –≤ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ
            group_results = self._search_by_category_and_group(category, target_group, language)

            # –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (—Ç–æ–ª—å–∫–æ 6-9)
            filtered = [r for r in group_results
                       if 6 <= int(r.get('metadata', {}).get('priority', 10)) <= 9]

            upsell_results.extend(filtered)

        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
        return sorted(upsell_results,
                     key=lambda x: int(x.get('metadata', {}).get('priority', 10)))

    def _get_upselling_groups(self, base_group: str) -> List[str]:
        """–ú–∞–ø–∏–Ω–≥ –±–∞–∑–æ–≤—ã—Ö –≥—Ä—É–ø–ø –∫ upselling –≥—Ä—É–ø–ø–∞–º"""

        upselling_map = {
            '—Ü–µ–Ω–∞': ['–±–æ–ª—å—à–∏–µ_—Ç–∏—Ä–∞–∂–∏', '–ø—Ä–µ–º–∏—É–º_–º–∞—Ç–µ—Ä–∏–∞–ª—ã'],
            '–º–∞—Ç–µ—Ä–∏–∞–ª—ã': ['–ø—Ä–µ–º–∏—É–º_–º–∞—Ç–µ—Ä–∏–∞–ª—ã', '—Å–ø–µ—Ü—ç—Ñ—Ñ–µ–∫—Ç—ã'],
            '—Å—Ä–æ–∫–∏': ['—Å—Ä–æ—á–Ω–æ–µ_–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'],
            '–º–∞–∫–µ—Ç': ['–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ_—Ä–µ—à–µ–Ω–∏—è', '—Å–ø–µ—Ü—ç—Ñ—Ñ–µ–∫—Ç—ã']
        }

        return upselling_map.get(base_group, [])
```

### üìù **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ —Å upselling:**

```python
def format_answer_with_upselling(results: List[Dict], language: str) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç —Å upselling –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏"""

    base_answers = [r for r in results if not r.get('metadata', {}).get('is_upselling')]
    upsell_options = [r for r in results if r.get('metadata', {}).get('is_upselling')]

    # –û—Å–Ω–æ–≤–Ω–æ–π –æ—Ç–≤–µ—Ç
    main_answer = base_answers[0]['answer'] if base_answers else ""

    # –î–æ–±–∞–≤–ª—è–µ–º upselling –æ–ø—Ü–∏–∏
    if upsell_options:
        upsell_text = "\n\n‚ú® –î–æ–¥–∞—Ç–∫–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:" if language == "ukr" else "\n\n‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:"

        for option in upsell_options:
            upsell_text += f"\n‚Ä¢ {option['answer']}"

        main_answer += upsell_text

    return main_answer
```

## –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### üìä **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:**

- –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–∫–∞–∑–æ–≤ upselling –æ–ø—Ü–∏–π
- CTR –ø–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –∑–∞–∫–∞–∑—ã –ø—Ä–µ–º–∏—É–º —É—Å–ª—É–≥
- –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ —Å upselling vs –±–µ–∑

### üéØ **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- –†–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ upselling –æ–ø—Ü–∏–π (1 vs 2 vs 3)
- –†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –ø–æ–¥–∞—á–∏
- –†–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–æ–∫–∞–∑–∞

–¢–∞–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏, –Ω–µ –≤—ã–≥–ª—è–¥—è –Ω–∞–≤—è–∑—á–∏–≤–æ, –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–∫–∞–∑–∞!
